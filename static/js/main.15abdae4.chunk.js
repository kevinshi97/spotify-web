(this["webpackJsonpspotify-web"]=this["webpackJsonpspotify-web"]||[]).push([[0],{193:function(t,e,a){t.exports=a.p+"static/media/logo.5d5d9eef.svg"},234:function(t,e,a){t.exports=a(454)},239:function(t,e,a){},240:function(t,e,a){},452:function(t,e,a){},454:function(t,e,a){"use strict";a.r(e);var r=a(1),s=a.n(r),n=a(71),o=a.n(n),i=(a(239),a(12)),c=a(13),u=a(35),l=a(34),h=a(193),p=a.n(h),d=(a(240),a(194)),m=a(206),_=function(){function t(){Object(i.a)(this,t),this.client_id="287daee6bafd4ce48e000a00a40d3f6f",this.redirect_uri="http://kevinshi97.github.io/spotify-web",this.scopes="user-top-read user-follow-read user-library-read",this.state=this.generateRandomString(16),this.auth_url="https://accounts.spotify.com/authorize?response_type=token&client_id="+encodeURIComponent(this.client_id)+"&redirect_uri="+encodeURIComponent(this.redirect_uri)+"&state="+encodeURIComponent(this.state)+"&scope="+encodeURIComponent(this.scopes),this.access_token=null,this.token_type=null,this.expires_in=null,this.returned_state=null,this.stored_state=null;var e=new URLSearchParams(window.location.hash.replace("#","?"));this.access_token=e.get("access_token"),this.token_type=e.get("token_type"),this.expires_in=e.get("expires_in"),this.returned_state=e.get("state"),this.stored_state=localStorage.getItem("spotify_auth_state")}return Object(c.a)(t,[{key:"logIn",value:function(){localStorage.setItem("spotify_auth_state",this.state),window.location.href=this.auth_url}},{key:"generateRandomString",value:function(t){for(var e="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<t;r++)e+=a.charAt(Math.floor(Math.random()*a.length));return e}},{key:"isLoggedIn",get:function(){return this.access_token&&this.stored_state===this.returned_state||!1}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),t}();_._instance=void 0;var f,k=_.Instance;!function(t){t.short_term="short_term",t.medium_term="medium_term",t.long_term="long_term"}(f||(f={}));var g=function(){function t(e){Object(i.a)(this,t),this.access_token=null,this.token_type=null,this.expires_in=null,this.returned_state=null,this.stored_state=null,this.app=void 0,this.app=e,this.access_token=k.access_token,this.token_type=k.token_type,this.expires_in=k.expires_in,this.returned_state=k.returned_state,this.stored_state=k.stored_state}return Object(c.a)(t,[{key:"logIn",value:function(){k.logIn()}},{key:"getTopTracks",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.medium_term;if(e<1||e>50||a<0||a>e)console.log("invalid params");else{var s="https://api.spotify.com/v1/me/top/tracks?&limit="+encodeURIComponent(e)+"&offset="+encodeURIComponent(a)+"&time_range="+encodeURIComponent(r),n={headers:{Authorization:"Bearer "+this.access_token},method:"GET"};fetch(s,n).then((function(t){return t.json()})).then((function(e){var a=e.items;t.app.setState({tracks:a,curr_track:a[0]||null}),console.log(t.app.state.tracks),console.log(t.app.state.curr_track)}))}}},{key:"getAudioFeature",value:function(t){var e=this,a=t.uri.split(":").pop()||"";console.log(a);var r="https://api.spotify.com/v1/audio-features/"+encodeURI(a),s={headers:{Authorization:"Bearer "+this.access_token},method:"GET"};fetch(r,s).then((function(t){return t.json()})).then((function(t){var a=t;console.log(a),e.app.setState({curr_audio_features:a})}))}},{key:"isLoggedIn",get:function(){return k.isLoggedIn}}]),t}(),v=a(195),y=a.n(v),b=a(19),E=(a(452),function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(t){var r;return Object(i.a)(this,a),(r=e.call(this,t)).state={audio_features:r.props.audio_features,track:r.props.track},r}return Object(c.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"chart-container"},s.a.createElement(b.f,null,s.a.createElement(b.e,{data:this.state.data},s.a.createElement(b.b,null),s.a.createElement(b.a,{dataKey:"feature"}),s.a.createElement(b.c,{angle:18,domain:[0,1],tick:!1}),s.a.createElement(b.d,{name:this.props.track?this.props.track.name:"",dataKey:"A",stroke:"#82ca9d",fill:"#82ca9d",fillOpacity:.6}),s.a.createElement(b.g,{scaleToFit:!0})))),s.a.createElement("div",{className:"song-container"},s.a.createElement("img",{src:this.state.image,className:"album-logo",alt:"logo"}),s.a.createElement("a",{href:this.state.url,target:"_blank",rel:"noopener noreferrer"},this.state.name)))}},{key:"componentDidMount",value:function(){this.props.track&&(this.props.track.external_urls&&this.props.track.name&&this.setState({name:this.props.track.name,url:this.props.track.external_urls.spotify||"#"}),this.props.track.album.images&&this.setState({image:this.props.track.album.images[0].url})),this.props.audio_features&&this.updateChartArea()}},{key:"componentDidUpdate",value:function(t,e){this.props.track&&this.props.track!==t.track&&(this.props.track.external_urls&&this.props.track.name&&this.setState({name:this.props.track.name,url:this.props.track.external_urls.spotify||"#"}),this.props.track.album.images&&this.setState({image:this.props.track.album.images[0].url})),this.props.audio_features&&this.props.audio_features!==t.audio_features&&this.updateChartArea()}},{key:"updateChartArea",value:function(){var t,e,a,r,s,n=this,o=(null===(t=this.props.audio_features)||void 0===t?void 0:t.tempo)||0,i=[{feature:"valence",A:null===(e=this.props.audio_features)||void 0===e?void 0:e.valence,fullMark:1},{feature:"danceability",A:null===(a=this.props.audio_features)||void 0===a?void 0:a.danceability,fullMark:1},{feature:"energy",A:null===(r=this.props.audio_features)||void 0===r?void 0:r.danceability,fullMark:1},{feature:"acousticness",A:null===(s=this.props.audio_features)||void 0===s?void 0:s.acousticness,fullMark:1},{feature:"tempo",A:o/250,fullMark:1}];this.setState({data:i},(function(){console.log("here"),console.log(n.state.data),console.log(i)}))}}]),a}(r.Component)),w=function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(t){var r;Object(i.a)(this,a);var s=[],n=[];if(t.tracks)for(var o=0;o<t.tracks.length;o++)s.push({id:o+1,label:t.tracks[o].name,title:t.tracks[o].name}),o>1&&n.push({to:o-1,from:o});return(r=e.call(this,t)).state={tracks:r.props.tracks,curr_track:r.props.curr_track,curr_audio_features:r.props.curr_audio_features,graph:{nodes:s,edges:n}},r}return Object(c.a)(a,[{key:"_updateCurrTrack",value:function(t){console.log(t);var e=t[0]-1;this.setState({curr_track:this.state.tracks?this.state.tracks[e]:this.state.curr_track})}},{key:"render",value:function(){var t=this;return s.a.createElement("div",null,s.a.createElement(y.a,{graph:this.state.graph,options:{layout:{improvedLayout:!0,hierarchical:!1},edges:{color:"#000000"},interaction:{zoomView:!0},height:"500px"},events:{selectNode:function(e){var a=e.nodes;e.edges;t._updateCurrTrack(a)}},getNetwork:function(t){}}),s.a.createElement(E,{audio_features:this.state.curr_audio_features,track:this.state.curr_track}))}},{key:"componentDidUpdate",value:function(t,e){var a=new g(this);this.state.tracks&&this.state.curr_track!==e.curr_track&&a.getAudioFeature(this.state.curr_track)}}]),a}(r.Component),I=function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(t){var r;return Object(i.a)(this,a),(r=e.call(this,t)).changeTheme=function(){r.setState({dark:!r.state.dark})},r.state={loggedIn:!1,dark:!1,query_top_limit:50,query_top_offset:0,query_top_timerange:f.short_term},r}return Object(c.a)(a,[{key:"render",value:function(){var t;return t=this.state.tracks&&this.state.curr_audio_features?s.a.createElement(w,{tracks:this.state.tracks,curr_track:this.state.curr_track,curr_audio_features:this.state.curr_audio_features}):s.a.createElement("div",null),s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header ".concat(this.state.dark?"":"dark")},s.a.createElement("img",{src:p.a,className:"App-logo",alt:"logo"}),s.a.createElement("p",null,"Edit ",s.a.createElement("code",null,"src/App.tsx")," and save to reload."),t,s.a.createElement(d.a,{id:"dar-mode-btn",icon:m.a,onClick:this.changeTheme})))}},{key:"componentDidMount",value:function(){var t=new g(this);t.isLoggedIn?(this.setState({loggedIn:!0}),t.getTopTracks(this.state.query_top_limit,this.state.query_top_offset,this.state.query_top_timerange)):(console.log("not logged in"),t.logIn())}},{key:"componentDidUpdate",value:function(t,e){var a=new g(this);this.state.tracks&&this.state.curr_track!==e.curr_track&&a.getAudioFeature(this.state.curr_track)}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(453);o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[234,1,2]]]);
//# sourceMappingURL=main.15abdae4.chunk.js.map